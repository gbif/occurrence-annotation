# 
# d <- occ_download_get("0051416-241126133413365") |> occ_download_import()
#   
# d_cc <- d %>%
#   filter(occurrenceStatus  == "PRESENT") %>%
#   filter(!basisOfRecord %in% c("FOSSIL_SPECIMEN","LIVING_SPECIMEN")) %>%
#   filter(year >= 1900) %>% 
#   filter(coordinatePrecision < 0.01 | is.na(coordinatePrecision)) %>% 
#   filter(coordinateUncertaintyInMeters < 10000 | is.na(coordinateUncertaintyInMeters)) %>%
#   filter(!coordinateUncertaintyInMeters %in% c(301,3036,999,9999)) %>% 
#   filter(!decimalLatitude == 0 | !decimalLongitude == 0) %>%
#   cc_cen(buffer = 2000) %>% # remove country centroids within 2km 
#   cc_sea() %>% # remove from ocean 
#   glimpse() # look at results of pipeline
# 
# # 7867 records removed
# 
# clean_download(d_cc)
# 
# library(dismo)
# library(raster)
# library(sp)
# library(geodata)
# 
# 




# library(sf)
# library(dplyr)
# library(ggplot2)

# simple on zero-zero inverted should be FALSE 
# wkt <- "POLYGON ((-180 -90, -90 -90, 0 -90, 90 -90, 180 -90, 180 90, 90 90, 0 90, -90 90, -180 90, -180 -90),(3.802159214685247 16.499712416214834,-14.744987094602806 13.253957142475457,-37.46522306953517 -6.452374137108194,-17.063374015608417 -28.708934425880884,15.394127780542078 -29.172618602247766,45.53320869485816 -6.684216225291635,19.103533269819508 15.340510465504835,3.802159214685247 16.499712416214834))"

# simple inverted FALSE at zero zero 
# wkt <- "POLYGON ((-180 -90, -90 -90, 0 -90, 90 -90, 180 -90, 180 90, 90 90, 0 90, -90 90, -180 90, -180 -90),(-34.45131837418646 31.801103451763517,-72.70479596305816 13.022123544499223,-124.17311126444918 14.41315909318547,-123.24575989212983 41.538352292567225,-105.62596495516112 60.08549011164807,-54.15764965377011 57.76709045533166,-34.45131837418646 31.801103451763517))"

# multi inverted TRUE at zero zero
# wkt <- "POLYGON ((-180 -90, -90 -90, 0 -90, 90 -90, 180 -90, 180 90, 90 90, 0 90, -90 90, -180 90, -180 -90),(-88.9335383709262 48.95720572215812,-127.88253373414102 22.295688208936042,-110.72643995395363 -31.027338327300896,-75.02318288406376 -29.172618602247766,-44.18856721499016 9.544534672783612,-88.9335383709262 48.95720572215812),(76.13599076595551 51.507430486243564,26.75422878759386 -16.65329866407157,68.02162805222869 -25.231345554165273,105.81143844514796 -16.885140752255012,129.22719219442345 24.15040793398917,76.13599076595551 51.507430486243564))"
# 
# simple FALSE at zero zero 
# wkt <- "POLYGON((-57.171554349118836 49.652723496501245,-88.23802059658308 42.929387841253465,-78.26893815780313 4.675910252381769,-30.97372950247083 13.485799230658898,-57.171554349118836 49.652723496501245))"

# simple 
# wkt <- "POLYGON((-2.674171433216287 13.068488566053063,-20.293949389770574 7.272504283124647,-12.890267369549662 -16.421465066095337,14.003092231855845 -18.97169407528439,33.47758991346325 -11.552840645693479,30.695518816090782 3.748550389855197,24.667675464564496 10.93557022146986,-2.674171433216287 13.068488566053063))"

# wkt <- "POLYGON ((-180 -90, -90 -90, 0 -90, 90 -90, 180 -90, 180 90, 90 90, 0 90, -90 90, -180 90, -180 -90),(-2.674171433216287 13.068488566053063,-20.293949389770574 7.272504283124647,-12.890267369549662 -16.421465066095337,14.003092231855845 -18.97169407528439,33.47758991346325 -11.552840645693479,30.695518816090782 3.748550389855197,24.667675464564496 10.93557022146986,-2.674171433216287 13.068488566053063))"

# multi small same hemisphere polygon
# wkt <- "POLYGON ((-180 -90, -90 -90, 0 -90, 90 -90, 180 -90, 180 90, 90 90, 0 90, -90 90, -180 90, -180 -90),(-128.33105499134513 61.29105283880831,-149.19657973143157 45.52598187199635,-140.38669075315443 23.96493086735957,-105.37896843802208 29.992757238471434,-128.33105499134513 61.29105283880831),(-119.52115752286076 7.73618845949153,-134.590706470226 -12.433826996459004,-113.02966395579642 -17.534293505044303,-110.71126005437641 -3.6239380181818603,-119.52115752286076 7.73618845949153))"

# multi 
# wkt <- "POLYGON ((-180 -90, -90 -90, 0 -90, 90 -90, 180 -90, 180 90, 90 90, 0 90, -90 90, -180 90, -180 -90),(-82.89054908065154 15.850559663425557,-59.93846252732851 31.615626385133915,-59.242944752985395 71.72381945395514,-115.11621727882579 72.41933722829828,-145.71899085971594 74.04221486516795,-152.67416860314717 25.355966416045817,-134.12703078406633 -24.489471248475525,-89.15020904973963 -35.38592203998924,-61.56133167399099 -6.86968480171403,-82.89054908065154 15.850559663425557),(68.26862456936774 75.89692610001387,-20.52579996816121 40.19368176543482,7.2949110055636766 25.8196505924127,49.489644662103444 28.601721689785187,68.26862456936774 75.89692610001387))"

# complex 
# wkt <- "POLYGON ((-180 -90, -90 -90, 0 -90, 90 -90, 180 -90, 180 90, 90 90, 0 90, -90 90, -180 90, -180 -90),(-68.9801935937891 31.615626385133915,-95.1780354208515 33.93402179634672,-131.80863537285353 -0.610024832625939,-121.14402666952324 -44.891320302402306,-68.9801935937891 -65.06133575835284,-6.383593902908132 -17.07060932867742,27.46492646151421 -9.419913810903068,20.973415914035456 34.62953957068984,62.47266575706095 25.355966416045817,96.55303669987393 52.48115537032397,77.77405679260963 76.36060603127716,17.264010424758027 71.26014376779547,-36.29085819966238 50.85829046876509,-68.9801935937891 31.615626385133915))"

# single
# wkt <- "POLYGON ((-180 -90, -90 -90, 0 -90, 90 -90, 180 -90, 180 90, 90 90, 0 90, -90 90, -180 90, -180 -90),(5.555604897383205 28.73887251466352,-34.382469929072855 10.395216429439543,-14.41344101919475 -15.37876887526005,48.97663485336233 -21.648118720461284,37.59894855063399 32.91843907813101,5.555604897383205 28.73887251466352))"

# multi
# wkt <- "POLYGON ((-180 -90, -90 -90, 0 -90, 90 -90, 180 -90, 180 90, 90 90, 0 90, -90 90, -180 90, -180 -90),(5.555604897383205 28.73887251466352,-34.382469929072855 10.395216429439543,-14.41344101919475 -15.37876887526005,48.97663485336233 -21.648118720461284,37.59894855063399 32.91843907813101,5.555604897383205 28.73887251466352),(-10.698276409456952 64.96178273138179,-32.75708860106879 50.5655007361104,-24.862357427863486 37.098005641598505,15.540119352322279 39.884383350576826,24.131444952772142 63.80079485375746,-10.698276409456952 64.96178273138179))"


# grepl("-180 -90, -90 -90, 0 -90, 90 -90, 180 -90, 180 90, 90 90, 0 90, -90 90, -180 90, -180 -90",wkt)


# x <- data.frame(geometry = wkt)
# x_c <- data.frame(decimalLongitude = c(0), decimalLatitude = c(0))
# x_c <- data.frame(decimalLongitude = c(-112), decimalLatitude = c(28))

# d_sf <- x_c %>% sf::st_as_sf(coords = c("decimalLongitude", "decimalLatitude"), crs = 4326)

# polygon <- x |>
  # dplyr::mutate(geometry = sf::st_as_sfc(geometry , crs = 4326)) |>
  # sf::st_sf() 
# |>
  # sf::st_make_valid()

# |>
  # sf::st_geometry() |>
  # sf::st_combine() |>

# library(ggplot2)

# ggplot() +
  # geom_sf(data = polygon, fill = "lightblue", color = "black") +
  # geom_sf(data = st_as_sf(
    # data.frame(lon = 0, lat = 0), 
    # coords = c("lon", "lat"), 
    # crs = 4326
  # ), color = "red", size = 3) +
  # theme_minimal()

# within <- sf::st_within(d_sf, polygon, sparse = FALSE)
# within

